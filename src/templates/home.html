{% extends "base.html" %}

{% block title %}My Overview - AIPMS{% endblock title %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock extra_css %}

{% block content %}
    <div class="personal-overview-container">
        
        <header class="dashboard-header">
            <h1 class="page-title"><i class="fas fa-user-circle"></i> My Personal Workload & Portfolio</h1>
            <div class="header-status">
                <span class="metric-label">Last Sync: Just Now</span>
            </div>
        </header>

        <!-- 1. Key Personal Metrics -->
        <div class="card personal-metric-bar-grid">
            <div class="metric-box">
                <p class="metric-value" id="tasks-due-today">5</p>
                <p class="metric-label">Tasks Due Today</p>
            </div>
            <div class="metric-box">
                <p class="metric-value" id="personal-risk-score">65%</p>
                <p class="metric-label">Personal Overload Risk (AI)</p>
            </div>
            <div class="metric-box">
                <p class="metric-value" id="my-velocity">100%</p>
                <p class="metric-label">My Velocity (Last Sprint)</p>
            </div>
            <div class="metric-box">
                <p class="metric-value" id="project-count">3</p>
                <p class="metric-label">Active Projects</p>
            </div>
        </div>
        
        <!-- 2. Main Content Grid -->
        <div class="main-content-grid">
            
            <!-- Widget 1: Urgent Tasks Across All Projects -->
            <div class="card urgent-tasks-widget full-span">
                <h2 class="widget-title"><i class="fas fa-fire-alt"></i> P1/P2 Tasks Across Portfolio</h2>
                <ul id="urgent-tasks-list" class="task-list scrollable-list">
                    <!-- Tasks loaded by JS -->
                </ul>
                <a href="/boards/backlog" class="view-link">Manage Priority in Backlog &rarr;</a>
            </div>

            <!-- Widget 2: AI Executive Assistant (Portfolio Summary) -->
            <div class="card ai-summary-widget small-span">
                <h2 class="widget-title"><i class="fas fa-robot"></i> AI Portfolio Assistant</h2>
                <textarea id="summary-prompt" placeholder="Ask the AI for a summary of high-risk projects or your upcoming week's workload..."></textarea>
                <button id="generate-summary-btn" class="btn btn-primary"><i class="fas fa-magic"></i> Get AI Insight</button>
                <div id="ai-output" class="ai-output hidden">Awaiting analysis...</div>
            </div>

            <!-- Widget 3: Quick Calendar & Deadlines -->
            <div class="card quick-calendar-widget small-span">
                <h2 class="widget-title"><i class="fas fa-calendar-check"></i> Key Deadlines</h2>
                <ul id="deadline-list" class="deadline-list scrollable-list">
                    <li><span class="deadline-date">Dec 20:</span> Backend Design Review (Core Backend)</li>
                    <li><span class="deadline-date">Dec 22:</span> UI Feature Freeze (Frontend Revamp)</li>
                    <li><span class="deadline-date">Jan 05:</span> Final Testing Due (Core Backend)</li>
                </ul>
                <a href="/boards/sprints" class="view-link">View Sprints Timeline &rarr;</a>
            </div>

        </div>
    </div>
{% endblock content %}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endblock extra_js %}