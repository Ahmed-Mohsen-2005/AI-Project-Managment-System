{% extends "base.html" %}

{% block title %}Board - AIPMS{% endblock title %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/board/board.css') }}">
{% endblock extra_css %}

{% block content %}
    <div class="board-container">
        
        <!-- Board Header and Controls -->
        <header class="board-header">
            <h1 class="page-title"><i class="fas fa-columns"></i> {{ t.kanban_board }}</h1>
            <div class="board-controls">
                
                <!-- Project Selection Dropdown -->
                <div class="control-group">
                    <label for="project-filter">{{ t.project }}:</label>
                    <select id="project-filter" class="filter-select">
                        <option value="all">View All Projects</option>
                        {% for project in projects %}
                            <option value="{{ project.project_id }}">{{ project.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                

                
                <button id="quick-add-task-btn" class="btn btn-primary btn-styled"><i class="fas fa-plus"></i> {{ t.add_task }}</button>
            </div>
        </header>

        <!-- Main Board Columns -->
        <div id="kanban-board" class="kanban-board">
            
            <!-- Column 1: To Do -->
            <div class="kanban-column" id="column-todo" data-status="To Do">
                <h2 class="column-title">{{ t.to_do }} <span class="task-count">(0)</span></h2>
                <div class="task-list" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                    <!-- Tasks will be inserted here by JavaScript -->
                </div>
            </div>

            <!-- Column 2: In Progress -->
            <div class="kanban-column" id="column-in-progress" data-status="In Progress">
                <h2 class="column-title">{{ t.in_progress }} <span class="task-count">(0)</span></h2>
                <div class="task-list" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                    <!-- Tasks will be inserted here by JavaScript -->
                </div>
            </div>

            <!-- Column 3: Under Review -->
            <div class="kanban-column" id="column-review" data-status="Under Review">
                <h2 class="column-title">{{ t.under_review }} <span class="task-count">(0)</span></h2>
                <div class="task-list" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                    <!-- Tasks will be inserted here by JavaScript -->
                </div>
            </div>
            
            <!-- Column 4: Done -->
            <div class="kanban-column" id="column-done" data-status="Done">
                <h2 class="column-title">{{ t.done }} <span class="task-count">(0)</span></h2>
                <div class="task-list" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                    <!-- Tasks will be inserted here by JavaScript -->
                </div>
            </div>

        </div>
    </div>
    
    <!-- Quick Add Task MODAL Structure -->
    <div id="quick-add-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 class="modal-title"><i class="fas fa-plus-circle"></i> {{ t.quick_create_task }}</h2>
            <form id="quick-add-form">
                <div class="form-group">
                    <label for="task-title-input">{{ t.title }} <span class="required">*</span></label>
                    <input type="text" id="task-title-input" required placeholder="{{ t.task_title_placeholder }}">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-priority">{{ t.priority }} <span class="required">*</span></label>
                        <select id="task-priority" required>
                            <option value="Medium">{{ t.medium }}</option>
                            <option value="High">{{ t.high }}</option>
                            <option value="Low">{{ t.low }}</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-status">{{ t.status }} <span class="required">*</span></label>
                        <select id="task-status" required>
                            <option value="To Do">{{ t.to_do }}</option>
                            <option value="In Progress">{{ t.in_progress }}</option>
                            <option value="Under Review">{{ t.under_review }}</option>
                            <option value="Done">{{ t.done }}</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-assignee">{{ t.assignee }} <span class="required">*</span></label>
                        <select id="task-assignee" required>
                            <option value="You">{{ t.you }} ({{ t.project_lead }})</option>
                            <option value="Alice J.">Alice J.</option>
                            <option value="Bob S.">Bob S.</option>
                            <option value="Charlie W.">Charlie W.</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-estimate">{{ t.estimate_hours }} <span class="required">*</span></label>
                        <input type="number" id="task-estimate" required min="0.5" step="0.5" placeholder="e.g., 8">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="task-due">{{ t.due_date }} <span class="required">*</span></label>
                    <input type="date" id="task-due" required>
                </div>
                
                <button type="submit" class="btn btn-primary btn-styled full-width-btn"><i class="fas fa-magic"></i> {{ t.create_task }}</button>
            </form>
        </div>
    </div>

{% endblock content %}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/board/board.js') }}"></script>
{% endblock extra_js %}